{"version":3,"sources":["../src/route.page.js"],"names":["marked","require","express","router","Router","config","PostModel","auth","get","req","res","next","render","title","adminRequired","id","query","findOne","_id","err","post","mkContent","content","clearCookie","cookieName","path","redirect","module","exports"],"mappings":";;AAAA,IAAIA,SAASC,QAAQ,QAAR,CAAb;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;AACA,IAAIE,SAASD,QAAQE,MAAR,EAAb;AACA,IAAIC,SAASJ,QAAQ,UAAR,CAAb;AACA,IAAIK,YAAYL,QAAQ,eAAR,CAAhB;AACA,IAAIM,OAAON,QAAQ,oBAAR,CAAX;;AAEA;AACAE,OAAOK,GAAP,CAAW,GAAX,EAAgB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvCD,MAAIE,MAAJ,CAAW,OAAX;AACD,CAFD;;AAIA;AACAT,OAAOK,GAAP,CAAW,QAAX,EAAqB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC5CD,MAAIE,MAAJ,CAAW,OAAX,EAAoB,EAAEC,OAAO,MAAT,EAApB;AACD,CAFD;;AAIA;AACAV,OAAOK,GAAP,CAAW,eAAX,EAA4BD,KAAKO,aAAjC,EAAgD,UAASL,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvED,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAT,OAAOK,GAAP,CAAW,aAAX,EAA0BD,KAAKO,aAA/B,EAA8C,UAASL,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACrE,MAAII,KAAKN,IAAIO,KAAJ,CAAUD,EAAnB;;AAEAL,MAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAEG,MAAF,EAAnB;AACD,CAJD;;AAMA;AACAZ,OAAOK,GAAP,CAAW,aAAX,EAA0B,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACjD,MAAII,KAAKN,IAAIO,KAAJ,CAAUD,EAAnB;;AAEAT,YAAUW,OAAV,CAAkB,EAAEC,KAAKH,EAAP,EAAlB,EAA+B,UAASI,GAAT,EAAcC,IAAd,EAAoB;AACjDA,SAAKC,SAAL,GAAiBrB,OAAOoB,KAAKE,OAAZ,CAAjB;AACAZ,QAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAEQ,UAAF,EAAnB;AACD,GAHD;AAID,CAPD;;AASA;AACAjB,OAAOK,GAAP,CAAW,SAAX,EAAsB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7CD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAT,OAAOK,GAAP,CAAW,SAAX,EAAsB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9CD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA;AACAT,OAAOK,GAAP,CAAW,UAAX,EAAuB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/CD,MAAIa,WAAJ,CAAgBlB,OAAOmB,UAAvB,EAAmC,EAAEC,MAAM,GAAR,EAAnC;AACAf,MAAIgB,QAAJ,CAAa,GAAb;AACD,CAHD;;AAKAC,OAAOC,OAAP,GAAiBzB,MAAjB","file":"route.page.js","sourcesContent":["var marked = require('marked');\r\nvar express = require('express');\r\nvar router = express.Router();\r\nvar config = require('./config');\r\nvar PostModel = require('./models/post');\r\nvar auth = require('./middlewares/auth');\r\n\r\n/* GET home page. */\r\nrouter.get('/', function(req, res, next) {\r\n  res.render('index');\r\n});\r\n\r\n/* GET posts page. */\r\nrouter.get('/posts', function(req, res, next) {\r\n  res.render('posts', { title: '我的文章' });\r\n});\r\n\r\n/* GET posts create page. */\r\nrouter.get('/posts/create', auth.adminRequired, function(req, res, next) {\r\n  res.render('create');\r\n});\r\n\r\n/* GET posts edit page. */\r\nrouter.get('/posts/edit', auth.adminRequired, function(req, res, next) {\r\n  var id = req.query.id;\r\n\r\n  res.render('edit', { id });\r\n});\r\n\r\n/* GET posts show page. */\r\nrouter.get('/posts/show', function(req, res, next) {\r\n  var id = req.query.id;\r\n\r\n  PostModel.findOne({ _id: id }, function(err, post) {\r\n    post.mkContent = marked(post.content);\r\n    res.render('show', { post });\r\n  });\r\n});\r\n\r\n/* GET signup page. */\r\nrouter.get('/signup', function(req, res, next) {\r\n  res.render('signup');\r\n});\r\n\r\n/* GET signin page. */\r\nrouter.get('/signin', function (req, res, next) {\r\n  res.render('signin');\r\n});\r\n\r\n/* GET signout */\r\nrouter.get('/signout', function (req, res, next) {\r\n  res.clearCookie(config.cookieName, { path: '/' });\r\n  res.redirect('/');\r\n});\r\n\r\nmodule.exports = router;\r\n"]}