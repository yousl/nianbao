{"version":3,"sources":["../../src/controllers/page.js"],"names":["homePage","req","res","next","render","postsPage","title","createPage","editPage","id","query","showPage","findOne","_id","exec","then","post","mkContent","content","catch","signupPage","signinPage","signout","clearCookie","cookieName","path","redirect"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA;AACO,IAAMA,8BAAW,SAAXA,QAAW,CAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAChDD,MAAIE,MAAJ,CAAW,OAAX;AACD,CAFM;;AAIP;AACO,IAAMC,gCAAY,SAAZA,SAAY,CAAUJ,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACjDD,MAAIE,MAAJ,CAAW,OAAX,EAAoB,EAAEE,OAAO,MAAT,EAApB;AACD,CAFM;;AAIP;AACO,IAAMC,kCAAa,SAAbA,UAAa,CAAUN,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAClDD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFM;;AAIP;AACO,IAAMI,8BAAW,SAAXA,QAAW,CAAUP,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAAA,MACxCM,EADwC,GACjCR,IAAIS,KAD6B,CACxCD,EADwC;;;AAGhDP,MAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAEK,MAAF,EAAnB;AACD,CAJM;;AAMP;AACO,IAAME,8BAAW,SAAXA,QAAW,CAAUV,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAAA,MACxCM,EADwC,GACjCR,IAAIS,KAD6B,CACxCD,EADwC;;;AAGhD,iBAAUG,OAAV,CAAkB,EAAEC,KAAKJ,EAAP,EAAlB,EAA+BK,IAA/B,GACGC,IADH,CACQ,gBAAQ;AACZC,SAAKC,SAAL,GAAiB,sBAAOD,KAAKE,OAAZ,CAAjB;AACAhB,QAAIE,MAAJ,CAAW,MAAX,EAAmB,EAACY,UAAD,EAAnB;AACD,GAJH,EAKGG,KALH,CAKShB,IALT;AAMD,CATM;;AAWP;AACO,IAAMiB,kCAAa,SAAbA,UAAa,CAAUnB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAClDD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFM;;AAIP;AACO,IAAMiB,kCAAa,SAAbA,UAAa,CAAUpB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAClDD,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFM;;AAIP;AACO,IAAMkB,4BAAU,SAAVA,OAAU,CAAUrB,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/CD,MAAIqB,WAAJ,CAAgB,iBAAOC,UAAvB,EAAmC,EAAEC,MAAM,GAAR,EAAnC;AACAvB,MAAIwB,QAAJ,CAAa,GAAb;AACD,CAHM","file":"page.js","sourcesContent":["import marked from 'marked'\r\nimport bcrypt from 'bcrypt'\r\nimport PostModel from '../models/post'\r\nimport config from '../config'\r\n\r\n/* GET home page. */\r\nexport const homePage = function (req, res, next) {\r\n  res.render('index')\r\n}\r\n\r\n/* GET posts page. */\r\nexport const postsPage = function (req, res, next) {\r\n  res.render('posts', { title: '我的文章' })\r\n}\r\n\r\n/* GET posts create page. */\r\nexport const createPage = function (req, res, next) {\r\n  res.render('create')\r\n}\r\n\r\n/* GET posts edit page. */\r\nexport const editPage = function (req, res, next) {\r\n  const { id } = req.query\r\n\r\n  res.render('edit', { id})\r\n}\r\n\r\n/* GET posts show page. */\r\nexport const showPage = function (req, res, next) {\r\n  const { id } = req.query\r\n\r\n  PostModel.findOne({ _id: id }).exec()\r\n    .then(post => {\r\n      post.mkContent = marked(post.content)\r\n      res.render('show', {post})\r\n    })\r\n    .catch(next)\r\n}\r\n\r\n/* GET signup page. */\r\nexport const signupPage = function (req, res, next) {\r\n  res.render('signup')\r\n}\r\n\r\n/* GET signin page. */\r\nexport const signinPage = function (req, res, next) {\r\n  res.render('signin')\r\n}\r\n\r\n/* GET signout */\r\nexport const signout = function (req, res, next) {\r\n  res.clearCookie(config.cookieName, { path: '/' })\r\n  res.redirect('/')\r\n}\r\n"]}